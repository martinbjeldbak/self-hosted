*.martinbjeldbak.com {
  tls me@martinbjeldbak.com {
    dns cloudflare {env.CLOUDFLARE_API_TOKEN}
  }

  log {
    output file /data/access.log
  }

  @dns host dns.martinbjeldbak.com
  handle @dns {
    encode gzip
    reverse_proxy adguardhome:3000
  }

  @homeassistant host homeassistant.martinbjeldbak.com
  handle @homeassistant {
    encode gzip
    reverse_proxy homeassistant:8123
  }

  @plex host plex.martinbjeldbak.com
  handle @plex {
    encode gzip
    reverse_proxy plex:32400
  }

  @plex host jackett.martinbjeldbak.com
  handle @jackett {
    encode gzip
    reverse_proxy jackett:9117
  }

  # Fallback for otherwise unhandled domains
  handle {
    abort
  }
}
