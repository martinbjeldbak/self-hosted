*.{$SITE_ADDRESS}

tls me@{$SITE_ADDRESS} {
	dns cloudflare {env.CLOUDFLARE_API_TOKEN}
}

log {
	output file /data/access.log
}

@dns host dns.{$SITE_ADDRESS}
handle @dns {
	reverse_proxy adguardhome:3000

	encode gzip
}

@homeassistant host homeassistant.{$SITE_ADDRESS}
handle @homeassistant {
	reverse_proxy homeassistant:8123

	encode gzip
}

@plex host plex.{$SITE_ADDRESS}
handle @plex {
	reverse_proxy plex:32400

	encode gzip
}

@jackett host jackett.{$SITE_ADDRESS}
handle @jackett {
	reverse_proxy gluetun:9117

	encode gzip
}

@radarr host movies.{$SITE_ADDRESS}
handle @radarr {
	reverse_proxy radarr:7878

	encode gzip
}

@lidarr host music.{$SITE_ADDRESS}
handle @lidarr {
	reverse_proxy lidarr:8686

	encode gzip
}

@sonarr host tv.{$SITE_ADDRESS}
handle @sonarr {
	reverse_proxy sonarr:8989

	encode gzip
}

@transmission host torrents.{$SITE_ADDRESS}
handle @transmission {
	reverse_proxy gluetun:9091

	encode gzip
}

@bazarr host subtitles.{$SITE_ADDRESS}
handle @bazarr {
	reverse_proxy bazarr:6767

	encode gzip
}

@portainer host portainer.{$SITE_ADDRESS}
handle @portainer {
	reverse_proxy portainer:9000

	encode gzip
}

@huginn host h.{$SITE_ADDRESS}
handle @huginn {
	reverse_proxy huginn:3000

	encode gzip
}

@nas host nas.{$SITE_ADDRESS}
handle @nas {
	reverse_proxy 192.168.1.250:5000

	encode gzip
}

@tautulli host tautulli.{$SITE_ADDRESS}
handle @tautulli {
	reverse_proxy tautulli:8181

	encode gzip
}

# Fallback for otherwise unhandled domains
handle {
	abort
}
