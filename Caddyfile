*.martinbjeldbak.com {
  tls me@martinbjeldbak.com {
    dns cloudflare {env.CLOUDFLARE_API_TOKEN}
  }

  log {
    output file /data/access.log
  }

  @dns host dns.martinbjeldbak.com
  handle @dns {
    reverse_proxy adguardhome:3000

    encode gzip
  }

  @homeassistant host homeassistant.martinbjeldbak.com
  handle @homeassistant {
    reverse_proxy homeassistant:8123

    encode gzip
  }

  @plex host plex.martinbjeldbak.com
  handle @plex {
    reverse_proxy plex:32400

    encode gzip
  }

  @jackett host jackett.martinbjeldbak.com
  handle @jackett {
    reverse_proxy jackett:9117

    encode gzip
  }

  @movies host movies.martinbjeldbak.com
  handle @movies {
    reverse_proxy radarr:7878

    encode gzip
  }

  @tv host tv.martinbjeldbak.com
  handle @tv {
    reverse_proxy sonarr:8989

    encode gzip
  }

  @torrents host torrents.martinbjeldbak.com
  handle @torrents {
    reverse_proxy transmission:9091

    encode gzip
  }

  @subtitles host subtitles.martinbjeldbak.com
  handle @subtitles {
    reverse_proxy bazarr:6767

    encode gzip
  }

  # Fallback for otherwise unhandled domains
  handle {
    abort
  }
}
